---
/**
 * WhatsAppButton Component - Specialized button for WhatsApp click-to-chat
 * Opens WhatsApp app on mobile or web.whatsapp.com on desktop
 */
import Button from './Button.astro';
import { getWhatsAppLink } from '../../utils/whatsapp';

interface Props {
  phoneNumber: string;
  message: string;
  label?: string;
  ariaLabel?: string;
  section?: string; // 'hero' | 'contact' - for tracking context
}

const {
  phoneNumber,
  message,
  label = 'Discuter sur WhatsApp',
  ariaLabel = `Contacter Make It Global sur WhatsApp: ${message.substring(0, 50)}...`,
  section = 'contact',
} = Astro.props;
const whatsappUrl = getWhatsAppLink(phoneNumber, message);
---

<Button
  variant="secondary"
  href={whatsappUrl}
  ariaLabel={ariaLabel}
  class="whatsapp-button"
  data-section={section}
>
  {label}
</Button>

<script>
  import { trackWhatsAppClick } from '../../utils/analytics';

  // Track WhatsApp button clicks
  document.addEventListener('DOMContentLoaded', () => {
    const whatsappButtons = document.querySelectorAll('.whatsapp-button');

    whatsappButtons.forEach((button) => {
      const section = button.getAttribute('data-section') || 'contact';

      button.addEventListener('click', () => {
        trackWhatsAppClick(section);
      });
    });
  });
</script>
